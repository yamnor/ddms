---
title: 📘 実習④ | 計算結果から物性値を算出
---

前章までで、シリコン結晶の様々な体積（格子定数）に対してエネルギーを計算し、リスト（`a_list`, `energies`）として保持しました。

本章では、この「生データ（Raw Data）」を解析し、物理的に意味のある **物性値** を導出してみます。

## データを表（Pandas DataFrame）形式に変換：

まず、Python のリスト形式を、解析しやすいように、**Pandas** というライブラリを用いて、Excel のシートのような「表」形式（**DataFrame**）に変換しておきます。

```python
import pandas as pd

# 前章で作成したリストから DataFrame 形式に変換します
data = {
    'Volume': volumes,
    'Energy': energies
}

df = pd.DataFrame(data)

# DataFrameの中身を表示
print(df)
```

**出力例：**

```term
       Volume     Energy
0   37.671917 -10.706424
1   38.135091 -10.730616
2   38.602047 -10.750747
3   39.072798 -10.766952
4   39.547361 -10.779418
5   40.025752 -10.788212
6   40.507985 -10.793517
7   40.994075 -10.795485
8   41.484039 -10.794191
9   41.977892 -10.789800
10  42.475648 -10.782420
```

## 物性値の算出：状態方程式フィッティング

次に、このデータ点をつないで、「真の極小点（平衡点）」と「曲率（硬さ）」を求めてみます。

物理学では、体積とエネルギーの関係を記述する **状態方程式（Equation of State: EOS）** という数式モデルがあります。

ここでは固体物理分野で代表的な **Birch-Murnaghan（バーチ・マーナハン）の式** を用います。

### Birch-Murnaghan 状態方程式

Birch-Murnaghan の状態方程式（3次）は、以下のように表します。

$$
E(V) = E_0 + \frac{9 V_0 B_0}{16} \left( \left[ \left( \frac{V_0}{V} \right)^{\frac{2}{3}} - 1 \right]^3 B_0 + \left[ \left( \frac{V_0}{V} \right)^{\frac{2}{3}} - 1 \right]^2 \left[ 6 - 4 \left( \frac{V_0}{V} \right)^{\frac{2}{3}} \right] \right)
$$

この式でデータを近似（フィッティング）することで、以下の物理量を決定できます。

- **$V_0$ (平衡体積)**: エネルギーが最小になる体積。安定な結晶構造の体積です。
- **$E_0$ (平衡エネルギー)**: その時のエネルギー。安定構造における全エネルギーです。
- **$B_0$ (体積弾性率)**: 物質の「硬さ」を表す指標です。
  - **硬い物質**: 圧縮しにくい $\rightarrow$ 体積弾性率が大きい。
  - **柔らかい物質**: 圧縮しやすい $\rightarrow$ 体積弾性率が小さい。

### 体積弾性率の導出

なぜこのフィッティングから「硬さ（体積弾性率）」が求まるのでしょうか？

体積弾性率 $B$ は、熱力学的に以下のように定義されます。

$$
B = -V \frac{\partial P}{\partial V}
$$

ここで、$P$ は圧力、$V$ は体積です。

また、圧力 $P$ はエネルギー $E$ の体積微分で表されます（$dE = -PdV + TdS$ より、等エントロピー / 等温過程において）。

$$
P = - \frac{\partial E}{\partial V}
$$

これらを組み合わせると、体積弾性率はエネルギーの **2階微分（曲率）** に比例することがわかります。

$$
B = -V \frac{\partial}{\partial V} \left( - \frac{\partial E}{\partial V} \right) = V \frac{\partial^2 E}{\partial V^2}
$$

つまり、**エネルギー vs 体積のグラフ（EOS曲線）の「底の曲がり具合（曲率）」が、物質の硬さに対応している** のです。

- 谷が鋭く尖っていれば、少し体積を変えただけでエネルギーが急増する（＝硬い）。
- 谷が緩やかであれば、体積を変えてもエネルギーはあまり変わらない（＝柔らかい）。

この物理的直観を数式化したものが、状態方程式へのフィッティング操作になります。

`ASE` には、このフィッティングを自動で行う便利なツールが備わっています。

```python
from ase.eos import EquationOfState
from ase.units import kJ

# フィッティングモデル（birchmurnaghan）の作成
eos = EquationOfState(volumes, energies, eos='birchmurnaghan')

# フィッティング実行
#   v0: 平衡体積 (Å^3)
#   e0: 最低エネルギー (eV)
#   B: 体積弾性率 (eV/Å^3)
v0, e0, B = eos.fit()

# 単位変換と物理量の算出
#   体積弾性率を GPa (ギガパスカル) に変換
B_GPa = B / kJ * 1.0e24

print(f"体積弾性率 B0  : {B_GPa:.3f} GPa")
```

**出力例：**

```term
体積弾性率 B0  : 88.828 GPa
```

### 解析結果の可視化

フィッティングがうまくいったか、グラフで確認してみます。

```python
eos.plot()
```

**出力例：**

![](https://gyazo.com/ac76b90177bbad792f71fbb3d13e1efe.png)

計算したデータ点（ドット）に対し、EOSの曲線がきれいにフィットしていることが分かります。曲線の底が平衡体積$V_0$（コード中の `v0`）、曲線の曲がり具合が体積弾性率$B_0$（コード中の `B`、単位換算後の `B_GPa`）に対応します。

## 精度検証：実験値との比較

最後に、計算結果（予測値）と実験値（正解）を比較して、今回のコンピュータ・シミュレーションの精度を評価します。

| 物性値        | 今回の計算値 (PBE) | 室温での代表的実験値の一例 | 誤差の傾向          |
| :--------- | :----------- | :------------ | :------------- |
| **平衡格子定数** | 約 5.473 Å    | 約 5.43 Å      | +0.7% (過大評価)   |
| **体積弾性率**  | 約 88.83 GPa  | 約 100 GPa 前後  | -10% 前後 (過小評価) |

### 誤差の原因とその解釈

おそらく、計算値は実験値と「完全には一致しなかった」はずです。

具体的には、格子定数は少し大きめに、硬さは少し柔らかめに出る傾向があります。これには明確な物理的理由があります。

1.  **PBE汎関数の特性**: 今回使用した **PBE** という計算手法（汎関数）は、原子間の結合を少し「緩く」見積もる傾向があります。そのため、原子間距離（格子定数）は広がり、結合のバネ（弾性率）は柔らかくなります。
2.  **温度の違い**: 計算は **絶対零度（0K）** ですが、実験値は **室温（300K）** です。通常、熱膨張で格子は広がりますが、DFT 特有の誤差の方が支配的です。

「計算が間違っている」のではなく、「PBEという近似レベルでは、これくらいの系統的なズレが生じる」と理解することが大切です。シミュレーションにおけるこのような「ズレの傾向」を知っていれば、未知の材料を計算した際も、結果を正しく解釈することが可能になります。

## 成果物の出力：CSVファイルへの保存

得られた結果は、後で機械学習の学習データとして使えるよう、CSVファイルに保存することにします。

```python
from google.colab import files

# CSVファイルとして書き出し
csv_filename = 'si_eos_result.csv'
df.to_csv(csv_filename, index=False)
```

次章では、ここで保存した `si_eos_result.csv` を読み込み、Volume から Energy を予測する機械学習モデルの学習に用いることにします。
