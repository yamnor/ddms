---
title: 📕 解説③ | 交換相関汎関数の選び方
---

Kohn-Sham 方程式において、唯一「近似」を含んでいるのが **交換相関汎関数（Exchange-Correlation Functional）** $E_{\mathrm{xc}}$ です。この項の厳密な形は誰も知りません。

DFT 計算の歴史は、この未知の関数をいかにうまく近似するかという歴史でもあります。

## ヤコブのはしご（Jacob's Ladder）

物理学者のジョン・パデューは、汎関数の近似レベルの階層を、旧約聖書に登場する天国への階段になぞらえて「**ヤコブのはしご**」と呼びました。

はしごを登る（上位の近似を使う）ほど計算精度は「天国（真の化学的精度）」に近づきますが、同時に計算コスト（計算時間）も増大します。

![](https://gyazo.com/00ac640f818d286fc7ba5f95bea8019d.png)

## 各階層の特徴

### 1段目：局所密度近似 (LDA: Local Density Approximation)

- **概念**: 「ある場所のエネルギーは、その場所の電子密度だけで決まる」と仮定する最も単純な近似。
- **特徴**: 均一な電子ガス（金属など）には意外と良い精度を持ちますが、結合を強く見積もりすぎる（結合距離が短くなる）傾向があります。
- **GPAWでの利用**: `xc='LDA'` と指定します。デフォルトでは **PW92** (Perdew & Wang 1992) という、電子ガスの厳密な性質を高精度にパラメータ化した汎関数が使われます。

### 2段目：一般化勾配近似 (GGA: Generalized Gradient Approximation)

- **概念**: 密度の値だけでなく、密度の「勾配（変化の激しさ）」も考慮に入れた近似。
- **特徴**: LDA の過結合の問題が改善され、固体、分子ともにバランスの良い精度が出ます。
- **GPAWでの利用**:
    - **PBE** (`xc='PBE'`): Perdew-Burke-Ernzerhof。**現在の材料科学分野における標準（デファクトスタンダード）** です。
    - **revPBE** (`xc='revPBE'`): Revised PBE。原子化エネルギーの精度などを改善したものです。
    - **RPBE** (`xc='RPBE'`): Revised revPBE。吸着エネルギーの記述に定評があり、触媒化学などの表面科学分野で好まれます。

### 3段目：メタ GGA (Meta-GGA)

- **概念**: 密度、勾配に加え、運動エネルギー密度（軌道のラプラシアン）も情報として使う。
- **特徴**: ファンデルワールス力のような弱い相互作用や、層状物質の記述が改善されることがあります。
- **GPAWでの利用**:
    - **M06-L** (`xc='M06-L'`): 化学反応や非共有結合相互作用の記述に優れた汎関数の一つです。

### 4段目：ハイブリッド汎関数 (Hybrid Functionals)

- **概念**: DFTの交換エネルギーに、ハートリー・フォック法（HF）の厳密な交換エネルギーを一定割合混ぜ合わせる手法。
- **特徴**: 特に半導体や絶縁体の **バンドギャップ** の予測精度が劇的に向上します（GGAはバンドギャップを過小評価する傾向があるため）。ただし計算コストは GGA の数倍〜数十倍に跳ね上がります。
- **GPAWでの利用**:
    - **PBE0** (`xc='PBE0'`): PBE に 25% の HF 交換項を混合したもの。固体のバンドギャップ予測によく使われます。
    - **B3LYP** (`xc='B3LYP'`): 量子化学（有機分子計算）の世界で圧倒的なシェアを持つ汎関数。GPAW でも利用可能です。

## どの汎関数を選ぶべきか？

実務上の選択指針は以下の通りです。

![](https://gyazo.com/852eb25f360a446acb49a721c8120dab.png)

1.  **まずはGGA (PBE) で計算する**。
    - ほとんどの結晶構造探索、安定性評価はこれで十分です。計算も高速です。
2.  **バンドギャップや光物性が重要なら Hybrid (PBE0 など) を検討する**。
    - GGAの結果を足場にして、一点計算（Single point）だけHybridで行うなどの工夫も有効です。
3.  **吸着や表面反応なら RPBE などを検討する**。
    - 系や目的に応じて、その分野で実績のある汎関数を選ぶことが大切です。

研究の現場では、まずGGAでスクリーニング（粗選別）を行い、有望な材料に対してのみHybridで精密計算を行うという「二段構え」の戦略がよく採られます。

本講座の実習では、このうち GGA の代表であり、GPAWユーザーの間でも最も標準的に使われている **PBE（`xc='PBE'`）** を用いてシリコン結晶の計算を行いました。

### 実践コード：汎関数の指定

GPAWでは、`xc` パラメータを変更するだけで簡単に汎関数を切り替えることができます。

```python
from gpaw import GPAW

# 1. LDA (Local Density Approximation)
# 最も基本的で高速。金属の構造計算などに。
# 内部では PW92 汎関数が使われます。
calc_lda = GPAW(xc='LDA')

# 2. GGA (Generalized Gradient Approximation) - PBE
# 【標準】多くの固体・分子計算でデファクトスタンダードとして使用される。
calc_pbe = GPAW(xc='PBE')

# 3. GGA - RPBE
# 触媒表面への吸着エネルギー計算などで強みを発揮する。
calc_rpbe = GPAW(xc='RPBE')

# 4. Hybrid Functional (PBE0)
# バンドギャップの精度が高いが、計算コストは非常に高い。
# ※注意: Hybrid計算は設定がより複雑になる場合があります
calc_hybrid = GPAW(xc='PBE0')
```
