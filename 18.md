---
title: ğŸ““ è³‡æ–™â‘£ | ASE å…¥é–€
---

ã“ã®ç« ã§ã¯ã€æœ¬è¬›åº§ã®å®Ÿç¿’ã§åŸå­æ§‹é€ ã®æ“ä½œã‚„è¨ˆç®—å®Ÿè¡Œã®å¸ä»¤å¡”ã¨ã—ã¦ä½¿ç”¨ã—ãŸ **ASE** (Atomic Simulation Environment) ã«ã¤ã„ã¦ã€ãã®å½¹å‰²ã¨åŸºæœ¬çš„ãªä½¿ã„æ–¹ã‚’è§£èª¬ã—ã¾ã™ã€‚

## ASE ã¨ã¯

**ASE** ã¯ã€Python ã§åŸå­ãƒ»åˆ†å­ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã†ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã‚»ãƒƒãƒˆã§ã™ã€‚
æœ¬è¬›åº§ã®æ–‡è„ˆã§è¨€ãˆã°ã€GPAW ãŒã€Œè¨ˆç®—ã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆè£…ç½®ã®å¿ƒè‡“éƒ¨ï¼‰ã€ã§ã‚ã‚‹ã®ã«å¯¾ã—ã€ASE ã¯ãã‚Œã‚’æ“ã‚‹ã€Œ**ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼**ã€ã«ã‚ãŸã‚Šã¾ã™ã€‚

æœ€å¤§ã®ç‰¹å¾´ã¯ã€**ã€Œè¨ˆç®—ã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆCalculatorï¼‰ã€ã‚’ã‚«ã‚»ãƒƒãƒˆã®ã‚ˆã†ã«äº¤æ›ã§ãã‚‹**ç‚¹ã§ã™ã€‚

ASE ã¨ã„ã†å…±é€šã®æ“ä½œç›¤ã‚’ä¸€ã¤è¦šãˆã‚Œã°ã€ãã®èƒŒå¾Œã«ã‚ã‚‹ã‚¨ãƒ³ã‚¸ãƒ³ã‚’ GPAW, VASP, Quantum ESPRESSO, LAMMPS ... ã¨åˆ‡ã‚Šæ›¿ãˆã‚‹ã ã‘ã§ã€åŒã˜ Python ã‚³ãƒ¼ãƒ‰ã‚’ä½¿ã£ã¦æ§˜ã€…ãªã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚

Google Colab ä¸Šã§ ASE ã‚’ä½¿ã†ãŸã‚ã®åŸºæœ¬æ“ä½œã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

Google Colab ã«ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ ASE ã¯å…¥ã£ã¦ã„ãªã„ãŸã‚ã€æœ€åˆã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ã§ã™ã€‚

```python
!pip install ase
```

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã€ã‚ˆãä½¿ã†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚

```python
from ase import Atoms
from ase.build import molecule, bulk
from ase.visualize.plot import plot_atoms
import matplotlib.pyplot as plt
```

## æ§‹é€ ã‚’ã¤ãã‚‹ (Build)

ASE ã«ã¯ã€åŸå­1å€‹ã‹ã‚‰è¤‡é›‘ãªçµæ™¶è¡¨é¢ã¾ã§ã€æ§˜ã€…ãªæ§‹é€ ã‚’ç°¡å˜ã«ä½œæˆã™ã‚‹ãŸã‚ã®æ©Ÿèƒ½ãŒå‚™ã‚ã£ã¦ã„ã¾ã™ã€‚

### åˆ†å­ã‚’ä½œã‚‹

`molecule` é–¢æ•°ã‚’ä½¿ã†ã¨ã€åŒ–å­¦å¼ã§åˆ†å­ã‚’å‘¼ã³å‡ºã›ã¾ã™ã€‚

```python
# æ°´åˆ†å­ã®ä½œæˆ
water = molecule('H2O')

# æƒ…å ±ã‚’è¡¨ç¤º
print(water)
```

**å‡ºåŠ›çµæœ**

```term
Atoms(symbols='OH2', pbc=False)
```

### çµæ™¶ã‚’ä½œã‚‹
`bulk` é–¢æ•°ã‚’ä½¿ã†ã¨ã€å‘¨æœŸçš„ãªçµæ™¶æ§‹é€ ã‚’ä½œæˆã§ãã¾ã™ã€‚

```python
# é‡‘(Au)ã®çµæ™¶ (é¢å¿ƒç«‹æ–¹æ ¼å­)
gold = bulk('Au', 'fcc', a=4.08)

print(gold)
```

**å‡ºåŠ›çµæœ**

```term
Atoms(symbols='Au', pbc=True, cell=[[0.0, 2.04, 2.04], [2.04, 0.0, 2.04], [2.04, 2.04, 0.0]])
```

### æ‰‹å‹•ã§å®šç¾©ã™ã‚‹

`Atoms` ã‚¯ãƒ©ã‚¹ã‚’ä½¿ã£ã¦ã€åŸå­ã®ç¨®é¡ã¨åº§æ¨™ã‚’ç›´æ¥æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

```python
# COåˆ†å­ã‚’æ‰‹å‹•ã§å®šç¾©
# positions ã¯ã‚ªãƒ³ã‚°ã‚¹ãƒˆãƒ­ãƒ¼ãƒ (Ã…)å˜ä½
co = Atoms('CO', positions=[(0, 0, 0), (0, 0, 1.1)])

# ç´°èƒ(cell)ã®å¤§ãã•ã‚’å®šç¾©ã—ã¦ã€çœŸã‚“ä¸­ã«é…ç½®
co.set_cell([10, 10, 10])
co.center()

print(co)
```

**å‡ºåŠ›çµæœ**

```term
Atoms(symbols='CO', pbc=False, cell=[10.0, 10.0, 10.0])
```

## æ§‹é€ ã‚’è¦‹ã‚‹ (Visualize)

ä½œæˆã—ãŸåˆ†å­ã‚„çµæ™¶ã®ç«‹ä½“æ§‹é€ ã‚’ç›®ã§è¦‹ã¦ç¢ºèªã™ã‚‹ã“ã¨ã¯ã€è¨ˆç®—çµæœã®æ¤œè¨¼ã‚„ã€è¨ˆç®—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®èª¿æ•´ã«ã¨ã¦ã‚‚é‡è¦ã§ã™ã€‚

ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã¯ `view(atoms)` ã¨ã„ã†ã‚³ãƒãƒ³ãƒ‰ã§å¯¾è©±çš„ãªãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼ãŒé–‹ãã¾ã™ãŒã€**Google Colab ä¸Šã§ã¯ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯å‹•ãã¾ã›ã‚“**ã€‚

ä»£ã‚ã‚Šã«ã€ä»¥ä¸‹ã®æ–¹æ³•ã§å¯è¦–åŒ–ã§ãã¾ã™ï¼š

1. **X3Dãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•**: `view(water, viewer='x3d')` ã‚’ä½¿ã†ã¨ã€Google Colabä¸Šã§ã‚‚ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãª3Dè¡¨ç¤ºãŒå¯èƒ½ã§ã™ã€‚

```python
from ase.visualize import view

# æ°´åˆ†å­ã®ä½œæˆ
water = molecule('H2O')

# X3Dãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼ã§è¡¨ç¤ºï¼ˆGoogle Colabä¸Šã§ã‚‚å‹•ä½œï¼‰
view(water, viewer='x3d')
```

**å‡ºåŠ›ä¾‹:**

![](https://gyazo.com/aa20ece53cb7f83546cf7309bf3b3ed6.png)

2. **matplotlib ã‚’ä½¿ã†æ–¹æ³•**: é™æ­¢ç”»ã¨ã—ã¦è¡¨ç¤ºã™ã‚‹æœ€ã‚‚ç¢ºå®Ÿãªæ–¹æ³•ã§ã™ã€‚ã“ã“ã§ã¯ã€æ°´åˆ†å­ã®æ§‹é€ ã‚’è¡¨ç¤ºã—ã¦ã¿ã¾ã™ã€‚

```python
from ase.visualize.plot import plot_atoms
import matplotlib.pyplot as plt

# æç”»ç”¨ã®ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ç”¨æ„
fig, ax = plt.subplots()

# æ°´åˆ†å­ã‚’å›è»¢ã•ã›ã¦æç”»
# rotation='10x,10y' ã®ã‚ˆã†ã«æŒ‡å®šã—ã¦ã‚¢ãƒ³ã‚°ãƒ«ã‚’å¤‰ãˆã‚‰ã‚Œã¾ã™
plot_atoms(water, ax, radii=0.3, rotation='45x,45y')

ax.set_title("Water Molecule")
ax.axis('off') # è»¸ã‚’æ¶ˆã™
plt.show()
```

**å‡ºåŠ›çµæœ**

![](https://gyazo.com/acfa70b9c68d91cb2de09115c9c953fa.png)

## 4. è¨ˆç®—ã™ã‚‹ (Calculator)

ASE ã§ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚„åŠ›ã‚’è¨ˆç®—ã™ã‚‹ã«ã¯ã€`Atoms` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã« **Calculatorï¼ˆè¨ˆç®—ã‚¨ãƒ³ã‚¸ãƒ³ï¼‰** ã‚’ã‚»ãƒƒãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã“ã§ã€ASE ã®å¼·åŠ›ãªæ©Ÿèƒ½ã§ã‚ã‚‹ã€Œè¨ˆç®—ã‚¨ãƒ³ã‚¸ãƒ³ã®åˆ‡ã‚Šæ›¿ãˆã€ã‚’ä½“é¨“ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

æœ¬è¬›åº§ã§ã¯é«˜ç²¾åº¦ãª **GPAW** ã‚’ä½¿ã„ã¾ã—ãŸãŒã€ã“ã“ã§ã¯ ASE ã«æœ€åˆã‹ã‚‰å†…è”µã•ã‚Œã¦ã„ã‚‹ç°¡æ˜“è¨ˆç®—ã‚¨ãƒ³ã‚¸ãƒ³ **EMT** (Effective Medium Theory) ã‚’ä½¿ã£ã¦ã¿ã¾ã™ã€‚

EMT ã¯ç²¾åº¦ã¯ä½ã„ã§ã™ãŒã€è¨ˆç®—ãŒä¸€ç¬ã§çµ‚ã‚ã‚‹ãŸã‚ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å‹•ä½œç¢ºèªã«æœ€é©ã§ã™ã€‚ã“ã“ã§ã¯ã€é‡‘ã®çµæ™¶ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’è¨ˆç®—ã—ã¦ã¿ã¾ã™ã€‚

```python
from ase.calculators.emt import EMT

# é‡‘(Au)ã®çµæ™¶
gold = bulk('Au', 'fcc', a=4.08)

# è¨ˆç®—ã‚¨ãƒ³ã‚¸ãƒ³ã‚’ã‚»ãƒƒãƒˆï¼ˆGPAWã®ä»£ã‚ã‚Šã«EMTã‚’ä½¿ã†ï¼‰
gold.calc = EMT()

# ã‚¨ãƒãƒ«ã‚®ãƒ¼è¨ˆç®—ã‚’å®Ÿè¡Œ
# ä½¿ã„æ–¹ã¯GPAWã®ã¨ãã¨å…¨ãåŒã˜ã§ã™ï¼
energy = gold.get_potential_energy()

print(f"Total Energy: {energy:.3f} eV")
```

**å‡ºåŠ›çµæœ**

```term
Total Energy: 0.003 eV
```

ã“ã®ã‚ˆã†ã«ã€`.calc = ...` ã®éƒ¨åˆ†ã‚’å¤‰ãˆã‚‹ã ã‘ã§ã€åŒã˜ `get_potential_energy()` ã¨ã„ã†å‘½ä»¤ã§è¨ˆç®—ãŒã§ãã¾ã™ã€‚ã“ã‚ŒãŒ ASE ã®çµ±ä¸€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®åˆ©ç‚¹ã§ã™ã€‚

## å‹•ã‹ã™ (Optimization / MD)

è¨ˆç®—ã‚¨ãƒ³ã‚¸ãƒ³ãŒã‚ã‚Œã°ã€æ§‹é€ æœ€é©åŒ–ã‚„åˆ†å­å‹•åŠ›å­¦æ³•ï¼ˆMDï¼‰ã‚‚æ•°è¡Œã§æ›¸ã‘ã¾ã™ã€‚
ã“ã‚Œã‚‰ã‚‚ã€Œã©ã®ã‚¨ãƒ³ã‚¸ãƒ³ã‚’ä½¿ã†ã‹ã€ã«é–¢ã‚ã‚‰ãšã€å…±é€šã®æ›¸ãæ–¹ã§å®Ÿè¡Œã§ãã¾ã™ã€‚

### æ§‹é€ æœ€é©åŒ–

åŸå­ã«ã‹ã‹ã‚‹åŠ›ãŒã‚¼ãƒ­ã«ãªã‚‹ä½ç½®ï¼ˆå®‰å®šæ§‹é€ ï¼‰ã‚’æ¢ã—ã¾ã™ã€‚

```python
from ase.build import molecule
from ase.calculators.emt import EMT
from ase.optimize import BFGS

# çª’ç´ åˆ†å­ã‚’ä½œæˆï¼ˆã‚ã–ã¨çµåˆè·é›¢ã‚’å°‘ã—ä¼¸ã°ã—ã¦ãŠã: 1.1 -> 1.3ï¼‰
n2 = molecule('N2')
n2.positions[1, 2] = 1.3 

# è¨ˆç®—ã‚¨ãƒ³ã‚¸ãƒ³ã‚»ãƒƒãƒˆ
n2.calc = EMT()

print(f"Initial energy: {n2.get_potential_energy():.3f} eV")

# æœ€é©åŒ–ã®å®Ÿè¡Œ
# trajectory='opt.traj' ã¨ã™ã‚‹ã¨ã€éç¨‹ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã§ãã¾ã™
opt = BFGS(n2, trajectory='opt.traj')
opt.run(fmax=0.01) # åŠ›ãŒ 0.01 eV/Ã… ä»¥ä¸‹ã«ãªã‚‹ã¾ã§

print(f"Final energy:   {n2.get_potential_energy():.3f} eV")
print(f"Final bond:     {n2.get_distance(0, 1):.3f} Ã…")
```

**å‡ºåŠ›çµæœ**
```term
Initial energy: 2.190 eV
      Step     Time          Energy          fmax
BFGS:    0 12:05:07        2.189778       17.311230
BFGS:    1 12:05:07        0.568986        4.075101
BFGS:    2 12:05:07        0.329309        2.102781
BFGS:    3 12:05:07        0.271206        0.833544
BFGS:    4 12:05:07        0.262905        0.099794
BFGS:    5 12:05:07        0.262777        0.004008
Final energy:   0.263 eV
Final bond:     0.998 Ã…
```

### åˆ†å­å‹•åŠ›å­¦ (MD)

æ¸©åº¦ã‚’è¨­å®šã—ã¦åŸå­ã‚’å‹•ã‹ã—ã¾ã™ã€‚

```python
from ase.md.velocitydistribution import MaxwellBoltzmannDistribution
from ase.md.verlet import VelocityVerlet
from ase import units

# é‡‘ã®çµæ™¶
gold = bulk('Au', 'fcc', a=4.08) * (2, 2, 2) # 2x2x2ã®ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚»ãƒ«
gold.calc = EMT()

# åˆæœŸæ¸©åº¦ã‚’è¨­å®š (300K)
MaxwellBoltzmannDistribution(gold, temperature_K=300)

# MDã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š (ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ— 5.0 fs)
dyn = VelocityVerlet(gold, 5.0 * units.fs)

# 10ã‚¹ãƒ†ãƒƒãƒ—ã”ã¨ã«æ¸©åº¦ã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
def printenergy():
    epot = gold.get_potential_energy() / len(gold)
    ekin = gold.get_kinetic_energy() / len(gold)
    print(f"Step: {dyn.get_number_of_steps():3d} | "
          f"Pot: {epot:.3f}eV | Kin: {ekin:.3f}eV | Temp: {ekin / (1.5 * units.kB):4.0f}K")

dyn.attach(printenergy, interval=10)

# 100ã‚¹ãƒ†ãƒƒãƒ—å®Ÿè¡Œ
dyn.run(steps=100)
```

**å‡ºåŠ›çµæœ**
```term
Step:   0 | Pot: 0.003eV | Kin: 0.036eV | Temp:  276K
Step:  10 | Pot: 0.012eV | Kin: 0.026eV | Temp:  201K
Step:  20 | Pot: 0.022eV | Kin: 0.017eV | Temp:  128K
Step:  30 | Pot: 0.017eV | Kin: 0.021eV | Temp:  163K
Step:  40 | Pot: 0.016eV | Kin: 0.022eV | Temp:  171K
Step:  50 | Pot: 0.013eV | Kin: 0.025eV | Temp:  196K
Step:  60 | Pot: 0.009eV | Kin: 0.030eV | Temp:  229K
Step:  70 | Pot: 0.014eV | Kin: 0.024eV | Temp:  185K
Step:  80 | Pot: 0.015eV | Kin: 0.023eV | Temp:  179K
Step:  90 | Pot: 0.012eV | Kin: 0.026eV | Temp:  202K
Step: 100 | Pot: 0.020eV | Kin: 0.018eV | Temp:  141K
```

## ä¿å­˜ã™ã‚‹ãƒ»èª­ã¿è¾¼ã‚€ (I/O)

è¨ˆç®—çµæœã‚„æ§‹é€ ãƒ‡ãƒ¼ã‚¿ã¯ã€æ§˜ã€…ãªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ä¿å­˜ãƒ»èª­ã¿è¾¼ã¿ãŒå¯èƒ½ã§ã™ã€‚

```python
from ase.io import read, write

# æ§‹é€ ã‚’ä¿å­˜
# æ‹¡å¼µå­ã§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’è‡ªå‹•åˆ¤åˆ¥ã—ã¾ã™
write('structure.xyz', gold)  # ä¸€èˆ¬çš„ãªXYZå½¢å¼
write('structure.cif', gold)  # çµæ™¶æ§‹é€ ã§ã‚ˆãä½¿ã†CIFå½¢å¼
write('structure.png', gold)  # ç”»åƒã¨ã—ã¦ä¿å­˜ã‚‚å¯èƒ½

# ASEç‹¬è‡ªã®ãƒã‚¤ãƒŠãƒªå½¢å¼ (è¨ˆç®—çµæœãªã©ã‚‚å…¨ã¦ä¿æŒã§ãã‚‹)
write('history.traj', gold)

# èª­ã¿è¾¼ã¿
atoms = read('structure.xyz')
```

ç‰¹ã« `.traj` ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ASE ã§ã®ä¸€é€£ã®è¨ˆç®—éç¨‹ï¼ˆæ§‹é€ æœ€é©åŒ–ã®è»Œè·¡ãªã©ï¼‰ã‚’è¨˜éŒ²ã™ã‚‹ã®ã«ä¾¿åˆ©ã§ã€å¾Œã‹ã‚‰ `ase gui` ã‚³ãƒãƒ³ãƒ‰ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒï¼‰ãªã©ã§ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å†ç”Ÿã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚
