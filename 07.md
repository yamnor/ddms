---
title: ğŸ“˜ å®Ÿç¿’â‘¥ | è‡ªå¾‹çš„ãªææ–™æ¢ç´¢ã‚·ã‚¹ãƒ†ãƒ 
---

å‰ç« ã§ã¯ã€æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ï¼ˆå¤šé …å¼å›å¸°ãƒ»ã‚¬ã‚¦ã‚¹éç¨‹å›å¸°ï¼‰ã‚’ç”¨ã„ã¦ç‰©æ€§ã‚’äºˆæ¸¬ã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã—ãŸã€‚

æœ¬ç« ã§ã¯ã€ã•ã‚‰ã«ä¸€æ­©é€²ã‚“ã§ã€**AIãŒã€Œæ¬¡ã«ã©ã®ã‚ˆã†ãªå®Ÿé¨“ãƒ»è¨ˆç®—ã‚’è¡Œã†ã¹ãã‹ã€ã‚’äººé–“ã«ææ¡ˆã™ã‚‹**ã€è‡ªå¾‹çš„ãªææ–™æ¢ç´¢ï¼ˆAutonomous Materials Searchï¼‰ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’ä½“é¨“ã—ã¾ã™ã€‚

## ãªãœè‡ªå¾‹æ¢ç´¢ãŒå¿…è¦ãªã®ã‹ï¼Ÿ

æœªçŸ¥ã®ææ–™ç©ºé–“ã¯åºƒå¤§ã§ã™ã€‚ã™ã¹ã¦ã®çµ„æˆãƒ»æ§‹é€ ã‚’è¨ˆç®—ã—ãŸã‚Šå®Ÿé¨“ã—ãŸã‚Šã™ã‚‹ã“ã¨ã¯ã€æ™‚é–“çš„ãƒ»ã‚³ã‚¹ãƒˆçš„ã«ä¸å¯èƒ½ã§ã™ã€‚

ãã“ã§ã€**ã€Œã§ãã‚‹ã ã‘å°‘ãªã„è©¦è¡Œå›æ•°ã§ã€æ¬²ã—ã„ææ–™ï¼ˆã¾ãŸã¯æ­£ã—ã„ç‰©ç†æ³•å‰‡ï¼‰ã‚’è¦‹ã¤ã‘å‡ºã™ã€** ãŸã‚ã®æˆ¦ç•¥ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚

ã“ã‚Œã‚’å®Ÿç¾ã™ã‚‹ã®ãŒ **ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ï¼ˆèƒ½å‹•å­¦ç¿’ï¼‰** ã§ã™ã€‚

## ä¸ç¢ºå®Ÿæ€§ã«åŸºã¥ãæ¢ç´¢ï¼ˆUncertainty Samplingï¼‰

å‰ç« ã§ç´¹ä»‹ã—ãŸ **ã‚¬ã‚¦ã‚¹éç¨‹å›å¸°ï¼ˆGPRï¼‰** ã‚’ç”¨ã„ã¦ã€AIãŒã€Œè¿·ã£ã¦ã„ã‚‹å ´æ‰€ï¼ˆä¸ç¢ºå®Ÿæ€§ãŒé«˜ã„å ´æ‰€ï¼‰ã€ã‚’ç‰¹å®šã—ã€ãã“ã‚’å„ªå…ˆçš„ã«æ¢ç´¢ã™ã‚‹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

### çŠ¶æ³è¨­å®š

- **ç›®çš„**: ã‚·ãƒªã‚³ãƒ³ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼æ›²ç·šã®å…¨ä½“åƒï¼ˆç‰¹ã«è°·åº•ã®ä½ç½®ï¼‰ã‚’ã€æœ€å°é™ã®è¨ˆç®—å›æ•°ã§æ˜ã‚‰ã‹ã«ã—ãŸã„ã€‚
- **åˆæœŸçŠ¶æ…‹**: ãƒ‡ãƒ¼ã‚¿ã¯æ¥µç«¯ã«å°‘ãªã„çŠ¶æ…‹ï¼ˆä¾‹ï¼š2ç‚¹ã®ã¿ï¼‰ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆã—ã¾ã™ã€‚
- **AIã®å½¹å‰²**: ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã€**ã€Œæ¬¡ã«ã©ã“ã‚’è¨ˆç®—ã™ã‚Œã°ã€æœ€ã‚‚æƒ…å ±ãŒå¾—ã‚‰ã‚Œã‚‹ã‹ï¼ˆä¸ç¢ºå®Ÿæ€§ãŒæ¸›ã‚‹ã‹ï¼‰ã€**ã‚’ææ¡ˆã—ã¾ã™ã€‚

### æ¢ç´¢ãƒ«ãƒ¼ãƒ—ã®å®Ÿè£…

ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ã€ä»¥ä¸‹ã® 5 ã¤ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’ç¹°ã‚Šè¿”ã™ã“ã¨ã§ã€è‡ªå‹•çš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã—ã¾ã™ã€‚

![](https://gyazo.com/6e99c097b97922ebea8c5da5f66a2664.png)

1.  **ãƒ‡ãƒ¼ã‚¿ã®æ­£è¦åŒ– (Normalization)**:
    ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã‚„ã™ãæ•´ç†ã—ã¾ã™ã€‚
2.  **å­¦ç¿’ (Training)**:
    ç¾åœ¨æŒã£ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ã€AIã«ã€Œæ³•å‰‡æ€§ã€ã‚’å­¦ç¿’ã•ã›ã¾ã™ã€‚
3.  **äºˆæ¸¬ã¨ä¸ç¢ºå®Ÿæ€§ã®è¨ˆç®— (Prediction)**:
    æœªçŸ¥ã®é ˜åŸŸã‚‚å«ã‚ã¦äºˆæ¸¬ã—ã€ã€Œã©ã“ãŒè‡ªä¿¡ãŒãªã„ã‹ï¼ˆä¸ç¢ºå®Ÿæ€§ï¼‰ã€ã‚‚è¨ˆç®—ã—ã¾ã™ã€‚
4.  **æ¬¡ã®ç‚¹ã®ææ¡ˆ (Proposal)**:
    ä¸ç¢ºå®Ÿæ€§ãŒæœ€ã‚‚é«˜ã„å ´æ‰€ã‚’ã€æ¬¡ã«è¨ˆç®—ã™ã‚‹å€™è£œã¨ã—ã¦é¸ã³ã¾ã™ã€‚
5.  **å®Ÿé¨“ã¨ãƒ‡ãƒ¼ã‚¿ã®è¿½åŠ  (Update)**:
    é¸ã°ã‚ŒãŸç‚¹ã«ã¤ã„ã¦ç¬¬ä¸€åŸç†è¨ˆç®—ã‚’å®Ÿè¡Œã—ã€ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ã—ã¾ã™ã€‚

ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€AIãŒã©ã®ã‚ˆã†ã«ãƒ‡ãƒ¼ã‚¿ã‚’ã€Œæ¬²ã—ãŒã‚‹ã€ã‹è¦³å¯Ÿã—ã¦ãã ã•ã„ã€‚

```python
import numpy as np
import matplotlib.pyplot as plt
from sklearn.gaussian_process import GaussianProcessRegressor
from sklearn.gaussian_process.kernels import RBF, ConstantKernel as C
from sklearn.preprocessing import StandardScaler
from ase.build import bulk
from gpaw import GPAW, PW

# --- æº–å‚™ï¼šDFTè¨ˆç®—ã‚’è¡Œã†é–¢æ•° ---
def run_dft_calculation(vol):
    """
    Volume (A^3) ã‚’å—ã‘å–ã‚Šã€DFTè¨ˆç®—ã§ã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV) ã‚’è¿”ã™é–¢æ•°
    """
    # 1. Volume -> æ ¼å­å®šæ•° a ã¸ã®å¤‰æ› (Si diamondæ§‹é€ ã®å ´åˆ: V = a^3 / 4)
    a = (vol * 4) ** (1/3)
    
    # 2. æ§‹é€ ã®ä½œæˆ
    atoms = bulk('Si', 'diamond', a=a)
    
    # 3. è¨ˆç®—å®Ÿè¡Œ (å®Ÿç¿’â‘¡ã¨åŒã˜è¨­å®š)
    #    txt=None ã§ãƒ­ã‚°å‡ºåŠ›ã‚’æŠ‘åˆ¶
    calc = GPAW(mode=PW(350), 
                xc='PBE', 
                kpts=(4, 4, 4), 
                txt=None)
    atoms.set_calculator(calc)
    
    return atoms.get_potential_energy()

# æ¢ç´¢ç¯„å›² (Volume: 35 ~ 45)
# AIãŒæ¢ç´¢å€™è£œã¨ã—ã¦è€ƒãˆã‚‹ã‚°ãƒªãƒƒãƒ‰ç‚¹
X_pool = np.linspace(35, 45, 100).reshape(-1, 1)

# --- åˆæœŸãƒ‡ãƒ¼ã‚¿ã®æº–å‚™ ---
print("åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’è¨ˆç®—ä¸­...")
# ä¸¡ç«¯ã®2ç‚¹ã ã‘çŸ¥ã£ã¦ã„ã‚‹çŠ¶æ…‹ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆ
X_train = np.array([[35.0], [45.0]])
y_train_list = []

# åˆæœŸç‚¹ã«ã¤ã„ã¦ã‚‚DFTè¨ˆç®—ã‚’å®Ÿè¡Œ
for x in X_train:
    print(f"Calculating for Volume = {x[0]:.2f}...")
    y = run_dft_calculation(x[0])
    y_train_list.append(y)

y_train = np.array(y_train_list)

# ã‚¹ã‚±ãƒ¼ãƒ©ãƒ¼ã®æº–å‚™
scaler_X = StandardScaler()
scaler_y = StandardScaler()

# --- æ¢ç´¢ãƒ«ãƒ¼ãƒ— (3å›ç¹°ã‚Šè¿”ã™) ---
for step in range(1, 4):
    print(f"\n--- Step {step} ---")
    
    # 1. ãƒ‡ãƒ¼ã‚¿ã®æ­£è¦åŒ–
    scaler_X.fit(X_train) # æ¯å›fitã—ç›´ã™ï¼ˆãƒ‡ãƒ¼ã‚¿ãŒå¢—ãˆã‚‹ãŸã‚ï¼‰
    X_train_scaled = scaler_X.transform(X_train)
    X_pool_scaled = scaler_X.transform(X_pool)
    
    y_train_scaled = scaler_y.fit_transform(y_train.reshape(-1, 1)).ravel()
    
    # 2. ã‚¬ã‚¦ã‚¹éç¨‹å›å¸°ãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’
    kernel = C(1.0, (1e-3, 1e3)) * RBF(1.0, (0.5, 10.0))
    gp = GaussianProcessRegressor(kernel=kernel, n_restarts_optimizer=9, alpha=0.001)
    gp.fit(X_train_scaled, y_train_scaled)
    
    # 3. äºˆæ¸¬ã¨ä¸ç¢ºå®Ÿæ€§(sigma)ã®ç®—å‡º
    y_pred_scaled, sigma_scaled = gp.predict(X_pool_scaled, return_std=True)
    
    # ã‚¹ã‚±ãƒ¼ãƒ«ã‚’å…ƒã«æˆ»ã™
    y_pred = scaler_y.inverse_transform(y_pred_scaled.reshape(-1, 1)).ravel()
    sigma = sigma_scaled * scaler_y.scale_[0]
    
    # 4. æ¬¡ã®ç‚¹ã®é¸å®šï¼ˆç²å¾—é–¢æ•°ï¼šæœ€å¤§ä¸ç¢ºå®Ÿæ€§ï¼‰
    next_idx = np.argmax(sigma)
    next_x = X_pool[next_idx]
    max_uncertainty = sigma[next_idx]
    
    print(f"AIã®ææ¡ˆ: Volume = {next_x[0]:.2f} A^3 (ä¸ç¢ºå®Ÿæ€§: {max_uncertainty:.4f})")
    
    # --- å¯è¦–åŒ– ---
    plt.figure(figsize=(8, 4))
    # æ­£è§£ã®é–¢æ•°ã¯æœªçŸ¥ãªã®ã§æç”»ã—ãªã„
    plt.plot(X_pool, y_pred, 'b-', label='AI Prediction')
    plt.fill_between(X_pool.ravel(), y_pred - 1.96*sigma, y_pred + 1.96*sigma, alpha=0.2, color='blue')
    plt.scatter(X_train, y_train, c='red', s=50, label='DFT Data', zorder=5)
    plt.scatter(next_x, y_pred[next_idx], c='green', s=100, marker='*', label='Next Point', zorder=6)
    plt.title(f'Step {step}: N={len(X_train)}')
    plt.xlabel('Volume')
    plt.ylabel('Energy')
    plt.legend()
    plt.show()
    
    # 5. ã€Œå®Ÿé¨“ã€ã‚’è¡Œã„ã€ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ã™ã‚‹
    print(f"DFTè¨ˆç®—ã‚’å®Ÿè¡Œä¸­... (Volume={next_x[0]:.2f})")
    new_y = run_dft_calculation(next_x[0])
    
    X_train = np.vstack([X_train, next_x])
    y_train = np.append(y_train, new_y)

print("\n--- Final Result ---")
# æœ€çµ‚ãƒ‡ãƒ¼ã‚¿ã§å†å­¦ç¿’
scaler_X.fit(X_train)
X_train_scaled = scaler_X.transform(X_train)
y_train_scaled = scaler_y.fit_transform(y_train.reshape(-1, 1)).ravel()

gp.fit(X_train_scaled, y_train_scaled)
y_pred_scaled, sigma_scaled = gp.predict(X_pool_scaled, return_std=True)

y_pred = scaler_y.inverse_transform(y_pred_scaled.reshape(-1, 1)).ravel()
sigma = sigma_scaled * scaler_y.scale_[0]

# æœ€çµ‚ã‚°ãƒ©ãƒ•æç”»
plt.figure(figsize=(8, 4))
plt.plot(X_pool, y_pred, 'b-', label='Final AI Prediction')
plt.fill_between(X_pool.ravel(), y_pred - 1.96*sigma, y_pred + 1.96*sigma, alpha=0.2, color='blue')
plt.scatter(X_train, y_train, c='red', s=50, label='All DFT Data', zorder=5)
plt.title(f'Final Result: N={len(X_train)}')
plt.xlabel('Volume')
plt.ylabel('Energy')
plt.legend()
plt.show()
```

**å‡ºåŠ›çµæœï¼š**

![](https://gyazo.com/44badb6a1caac15a0bfb5692e632d381.png)

**Step 1**: åˆæœŸãƒ‡ãƒ¼ã‚¿ï¼ˆä¸¡ç«¯ï¼‰ã®ã¿ã§ã¯æƒ…å ±ãŒè¶³ã‚Šãªã„ãŸã‚ã€AIã¯ã€Œé–“ã®é ˜åŸŸã€ã®ä¸ç¢ºå®Ÿæ€§ãŒé«˜ã„ã¨åˆ¤æ–­ã—ã€ä¸­å¤®ä»˜è¿‘ã®è¨ˆç®—ã‚’ææ¡ˆã—ã¾ã™ã€‚

![](https://gyazo.com/3b833d11d157594d7f20b01897559a17.png)

**Step 2**: ãƒ‡ãƒ¼ã‚¿ãŒå¢—ãˆã‚‹ã«ã¤ã‚Œã¦ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼æ›²ç·šï¼ˆçŠ¶æ…‹æ–¹ç¨‹å¼ï¼‰ã®æ¦‚å½¢ãŒè¦‹ãˆã¦ãã¾ã™ã€‚


![](https://gyazo.com/0b8c3064ef9bc9386a0d1b27b48988bb.png)

**Step 3**: ã‚ãšã‹æ•°ç‚¹ã®è¨ˆç®—ã§ã€åŠ¹ç‡çš„ã«å…¨ä½“ã®å½¢çŠ¶ã‚’æŠŠæ¡ã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

![](https://gyazo.com/bc25a81979f6a3df1e8a6b450442378e.png)

**Final**: AI ãŒã€Œã“ã®ä½“ç©ã‚’è¨ˆç®—ã—ã¦ï¼ã€ã¨æŒ‡ç¤ºã‚’å‡ºã—ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãŒè‡ªå‹•ã§ç¬¬ä¸€åŸç†è¨ˆç®—ã‚’å®Ÿè¡Œã—ã€æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ãŒè³¢ããªã£ã¦ã„ãæ§˜å­ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¦³å¯Ÿã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚

ã“ã®ã‚ˆã†ã«ã€AIãŒã€Œæ¬¡ã«è¨ˆç®—ã™ã¹ãç‚¹ã€ã‚’æŒ‡ç¤ºã™ã‚‹ã“ã¨ã§ã€**æœ€å°é™ã®è¨ˆç®—ã‚³ã‚¹ãƒˆ** ã§ç›®çš„ã‚’é”æˆã™ã‚‹ **è‡ªå¾‹å‹ã®ææ–™è¨ˆç®—ã‚·ã‚¹ãƒ†ãƒ ** ã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚

## ãã®ä»–ã®ç™ºå±•çš„ãƒˆãƒ”ãƒƒã‚¯

### Delta Learningï¼ˆå·®åˆ†å­¦ç¿’ï¼‰

**ã€Œè¨ˆç®—ã¯é€Ÿã„ãŒã‚ºãƒ¬ãŒã‚ã‚‹ã€å®Ÿé¨“ã¯æ­£ã—ã„ãŒé…ã„ã€** ã¨ã„ã†ã‚¸ãƒ¬ãƒ³ãƒã‚’è§£æ±ºã™ã‚‹æ‰‹æ³•ã§ã™ã€‚

**è€ƒãˆæ–¹**: 

$$ E_{\text{exp}}(V) \approx E_{\text{PBE}}(V) + \Delta(V) $$

å®Ÿé¨“å€¤ $E_{\text{exp}}$ ã‚’ç›´æ¥äºˆæ¸¬ã™ã‚‹ã®ã§ã¯ãªãã€è¨ˆç®—å€¤ $E_{\text{PBE}}$ ã¨ã®ã€Œå·®åˆ† $\Delta(V)$ã€ã‚’æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã«å­¦ç¿’ã•ã›ã¾ã™ã€‚

**ãƒ¡ãƒªãƒƒãƒˆ**: 

å·®åˆ† $\Delta(V)$ ã¯ã€å…¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ãã®ã‚‚ã®ã‚ˆã‚Šã‚‚æ»‘ã‚‰ã‹ã§å˜ç´”ãªé–¢æ•°ã«ãªã‚‹ã“ã¨ãŒå¤šã„ãŸã‚ã€å°‘æ•°ã®å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã§ã‚‚é«˜ç²¾åº¦ã«å­¦ç¿’ã§ãã¾ã™ã€‚

### è‡ªå‹•åŒ–ã¨è‡ªå¾‹åŒ–ï¼ˆAutonomous Agentï¼‰

ãƒã‚¤ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆè¨ˆç®—ã«ãŠã„ã¦ã€äººé–“ãŒæ•°åƒä»¶ã®å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ‰‹ä½œã‚Šã—ã€ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ãŸã³ã«ä¿®æ­£ã™ã‚‹ã®ã¯éåŠ¹ç‡ã§ã™ã€‚

ãã“ã§ã€**Custodian**ï¼ˆç®¡ç†äººï¼‰ã‚„ **Agent** ã¨å‘¼ã°ã‚Œã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒå°å…¥ã•ã‚Œã¦ã„ã¾ã™ã€‚

1.  **Jobã®æŠ•å…¥**: è¨ˆç®—æ¡ä»¶ã‚’æ±ºã‚ã¦ã‚µãƒ¼ãƒãƒ¼ã«æŠ•ã’ã‚‹ã€‚
2.  **ã‚¨ãƒ©ãƒ¼ç›£è¦–**: è¨ˆç®—ãŒæ­¢ã¾ã£ãŸã‚‰ãƒ­ã‚°ã‚’è§£æã™ã‚‹ï¼ˆã€ŒåæŸã—ãªã‹ã£ãŸã€ã€Œãƒ¡ãƒ¢ãƒªä¸è¶³ã€ãªã©ï¼‰ã€‚
3.  **è‡ªå‹•ä¿®å¾©**: ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡ã«å¿œã˜ã¦ã€é©åˆ‡ãªå¯¾å‡¦ï¼ˆæ··åˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å¤‰æ›´ã€ãƒ¡ãƒ¢ãƒªå¢—è¨­ãªã©ï¼‰ã‚’è¡Œã£ã¦å†è¨ˆç®—ã™ã‚‹ã€‚
4.  **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç™»éŒ²**: æˆåŠŸã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•ã§DBã«æ ¼ç´ã™ã‚‹ã€‚

ã“ã®ä»•çµ„ã¿ã«ã‚ˆã‚Šã€ç ”ç©¶è€…ã¯ã€Œã©ã®ç‰©è³ªã‚’è¨ˆç®—ã™ã‚‹ã‹ã€ã¨ã„ã†æˆ¦ç•¥æ±ºå®šã«é›†ä¸­ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
