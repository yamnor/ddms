---
title: 📕 解説① | 第一原理計算の基礎理論
---

本章から「解説編」に入ります。

実習編では、コンピュータを「データをつくる装置」として扱い、第一原理計算に基づいてデータを生成・解析する手順を学びました。

解説編では、その「装置」の内部で何が起きているのか、ブラックボックスの蓋を開けて、その仕組みを解説します。

## なぜ「第一原理」なのか

**第一原理計算（First-Principles Calculation）** とは、実験の結果や経験的なフィッティングパラメータを一切使わず、量子力学の基本原理のみに基づいて物質の性質を計算する手法の総称です。

原子の種類と配置さえ決まれば、その物質が金属か絶縁体か、硬いか柔らかいか、透明か不透明かといった性質を、原理的にはすべて予測できる点が最大の強みです。

![](https://gyazo.com/0c7e4f406e4ab504891bf77dd1e4c054.jpeg)

## 多体問題の壁と密度汎関数理論（DFT）

物質は、原子核と無数の電子から構成されています。これらすべての粒子が互いに相互作用する系（多体問題）のシュレーディンガー方程式を厳密に解くことは、現代のスーパーコンピュータをもってしても不可能です。

そこで登場するのが、**密度汎関数理論（DFT: Density Functional Theory）** です。

![](https://gyazo.com/d02cb3b0477d06d0bb519ac11067937c.jpeg)

### Hohenberg-Kohn の定理（1964年）

DFT の基礎となるこの定理は「**系の基底状態（最も安定な状態）のエネルギーや物性は、電子密度 $n(\boldsymbol{r})$ だけで一意に決まる**」ことを主張します。

本来、電子の「波動関数」は、$N$個の電子があれば $3N$ 次元の複雑な変数ですが、「電子密度」はたった3次元の関数です。この定理により、解くべき問題を大いに簡略化できることが保証されました。

- **汎関数（Functional）とは？**
  - 「数」を入れると「数」を返すのが **関数**（例：$y = f(x)$）。
  - 「関数」を入れると「数」を返すのが **汎関数**（例：$E = E[n(\boldsymbol{r})]$）。

![](https://gyazo.com/469044ee6f6ee09d86e37beb27ba5c09.jpeg)

DFTでは、空間ごとの電子密度 $n(\boldsymbol{r})$ という「関数」を入力すると、エネルギー $E$ という「数値」が返ってくる枠組みを扱います。

## Kohn-Sham 方程式：仮想の一電子系

定理は「できる」ことを保証しましたが、「どうやって解くか」は教えてくれませんでした。これを解決したのが **Kohn-Sham 法（1965年）** です。

彼らは、複雑に相互作用し合う現実の電子系を、**「相互作用のない仮想的な電子（準粒子）」が、「有効ポテンシャル」の中を独立運動している系** に置き換えました。

この仮想系が満たす方程式を **Kohn-Sham 方程式** と呼びます。

$$
\left( -\frac{\hbar^2}{2m}\nabla^2 + v_{\mathrm{eff}}(\boldsymbol{r}) \right) \phi_i(\boldsymbol{r}) = \varepsilon_i \phi_i(\boldsymbol{r})
$$

ここで、$v_{\mathrm{eff}}(\boldsymbol{r})$（有効ポテンシャル）は、以下の3つの項の和で表されます。

1. **外部ポテンシャル** $v_{\mathrm{ext}}$: 原子核が電子を引き寄せる静電引力。
2. **ハートリーポテンシャル** $v_{\mathrm{H}}$: 電子同士が反発し合う古典的な静電斥力。平均的な「雲」としての反発。
3. **交換相関ポテンシャル** $v_{\mathrm{xc}}$: 量子力学特有の効果（パウリの排他律など）を全て押し込んだ項。

## 自己無撞着場（SCF）サイクル：つじつま合わせ

Kohn-Sham 方程式には、厄介な性質があります。

「方程式を解くためのポテンシャル $v_{\mathrm{eff}}$ を決めるには電子密度  が必要ですが、電子密度を知るには方程式を解いて波動関数 $\phi_i$ を求めなければならない」という、鶏と卵のような関係 です。

これを解くために、**自己無撞着場（SCF: Self-Consistent Field）サイクル** と呼ばれる反復計算を行います。

1. **Guess**: 電子密度 $n(\boldsymbol{r})$ を適当に仮定する（原子の重ね合わせなど）。
2. **Construct**: 仮定した密度から、有効ポテンシャル $v_{\mathrm{eff}}$ を作る。
3. **Solve**: Kohn-Sham 方程式を解き、新しい波動関数 $\phi_i$ を得る。
4. **Update**: 新しい波動関数から、新しい電子密度 $n'(\boldsymbol{r})$ を計算する。
5. **Check**: 最初と最後の密度が一致（収束）したか？
  - **No**: 新しい密度（または古い密度との混合）を使って 2. へ戻る。
  - **Yes**: 終了。この状態が「解」である。

SCF は、実験装置のPID制御や、光学系のオートフォーカス機能に似ています。現状のズレ（誤差）を検出し、パラメータを微調整してフィードバックし、最終的に安定した状態（合焦点）に収束させるプロセスです。計算機の中で、電子たちは居心地の良い分布を求めて、このサイクルを何度も回しています。

![](https://gyazo.com/9f6a7549f0db5520b9a24c160b100695.jpeg)

### 実践コード：SCF 計算の実行

GPAW を用いて実際に SCF 計算を行う最も基本的なコードは以下のようになります。`get_potential_energy()` を呼び出した瞬間、内部で上記のSCFサイクルが回り始めます。

```python
from ase import Atoms
from ase.visualize.plot import plot_atoms
import matplotlib.pyplot as plt
from gpaw import GPAW

# 水素分子を定義
d = 0.74  # 結合長
atoms = Atoms('H2', positions=[(0, 0, 0), (0, 0, d)])
atoms.center(vacuum=2.5)

# --- 構造の可視化 ---
# 分子の立体構造を可視化する際には、view(atoms, viewer='x3d') を使うと、
# Google Colab上でもインタラクティブな3D表示が可能です。
# ここでは、matplotlib を使った静止画での可視化を行います。

fig, ax = plt.subplots(figsize=(8, 4))
plot_atoms(atoms, ax, radii=0.5, rotation=('0x,90y,0z'))
plt.title('H2 Molecule')
plt.axis('equal')
plt.axis('off')
plt.tight_layout()
plt.show()

# X3Dビューワーを使用する場合は、以下のように記述します：
# from ase.visualize import view
# view(atoms, viewer='x3d')
```

**出力例：**

![](https://gyazo.com/9177c9f40ffdbf25028cea8be89229ca.png)

```python
# 計算エンジン（Calculator）の設定
# ここでコーン・シャム方程式の解き方（交換相関汎関数など）を指定しています
calc = GPAW(xc='PBE')  # xc='PBE' は式中の v_eff の中の交換相関ポテンシャル v_xc を、PBE 近似で与えることに対応
atoms.set_calculator(calc)

# エネルギー計算の実行
e = atoms.get_potential_energy()
print(f'Total Energy: {e:.3f} eV')
```

**出力例：**

```term
Total Energy: -6.673 eV
```

### コラム：エネルギー値の「基準」について

第一原理計算で出力される全エネルギーの値（例：`-10.78 eV`）は、**絶対的な数値ではありません**。

この値は、計算設定（擬ポテンシャルや汎関数の種類）ごとに異なる「基準点（原子が無限遠に離れた状態など）」からの相対値です。したがって、**異なる計算設定で得られたエネルギー値を直接比較することはできません**（例：PBEで計算した値とLDAで計算した値を比べるのは無意味）。

物理的な意味を持つのは、**「同じ設定で計算された、異なる構造間のエネルギー差」**（例：結合エネルギー、凝集エネルギー、相変態エネルギー）だけです。
